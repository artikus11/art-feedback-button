MicroModal.init();const triggerEvent=(e,t,o)=>{const n=new CustomEvent(`afb_${t}`,{bubbles:!0,detail:o});"string"==typeof e&&(e=document.querySelector(e)),e.dispatchEvent(n)};function viewModal(e,t){return fetch(e,t).then(function(e){return 200!==e.status?Promise.reject(new Error(e.statusText)):Promise.resolve(e)}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){console.log("error",e)})}document.querySelector(".button-shortcode-js").addEventListener("click",function(e){let t=e.target,o=t.dataset.windowUrl,n={emails:t.dataset.afbEmails};this.setAttribute("disabled","disabled"),viewModal(o,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(n)}).then(function(e){t.insertAdjacentHTML("afterend",e.html),t.removeAttribute("disabled"),MicroModal.show("afb-modal",{debugMode:!0,disableScroll:!0,onShow:function(e){const t=e.querySelector("input[type=tel]");VMasker(t).maskPattern(t.dataset.mask),triggerEvent(e,"open")},onClose:function(e){triggerEvent(e,"close"),e.remove()},closeTrigger:"data-afb-close",disableFocus:!1,awaitCloseAnimation:!0});const o=document.querySelector(".afb-modal__container"),n=document.querySelector(".afb-modal__content"),r=document.querySelector(".afb-modal-form");document.querySelector(".js-send-modal-form").addEventListener("click",function(e){const t=new FormData(r),s=r.getAttribute("action");e.target.setAttribute("disabled","disabled"),o.classList.add("preload"),(async()=>{let a=await fetch(s,{method:"POST",body:t}),c=await a.json();if(a.ok&&(o.classList.remove("preload"),e.target.removeAttribute("disabled")),"error"===c.status){let e=c.message;for(let t in e){o.querySelector('label[for="'+t+'"]').insertAdjacentHTML("beforeend",'<span class="error">'+e[t]+"</span>")}setTimeout(function(){o.querySelectorAll(".error").forEach(function(e,t,o){e.remove()})},5e3)}"success"===c.status&&(triggerEvent(r,"send_success",c),n.innerHTML="",n.insertAdjacentHTML("afterend",'<span class="success">'+c.message+"</span>"),setTimeout(function(){MicroModal.close("afb-modal")},3e3))})()})})});